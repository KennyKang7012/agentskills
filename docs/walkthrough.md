# 測試與驗證指南 (Walkthrough)

本指南將引導您如何測試與驗證新開發的 FA 報告優化系統。

## 1. 準備工作與啟動伺服器

### 步驟 1：配置環境變數
請確保您已建立 `.env` 檔案並正確設定 `OPENAI_API_KEY` 與 `SKILL_PATH`：
```bash
cp .env.example .env
# 編輯 .env 填入金鑰與技能路徑
```

### 步驟 2：執行啟動指令
請確保您在專案根目錄下，執行以下指令：

```bash
# 設定 PYTHONPATH 以確保模組讀取正確
export PYTHONPATH=$PYTHONPATH:.
uv run app/main.py
```

伺服器啟動後，請開啟瀏覽器並訪問：
[http://localhost:8000](http://localhost:8000)

## 2. 驗證步驟
## 2. UI 測試步驟

### 步驟 A：前端介面測試
1. **載入驗證**: 確認網頁是否正確顯示「FA Report Improvement」標題，且具備現代化的雙區域上傳設計。
2. **樣式檢查**: 確認是否有深色背景、紫色漸層標題以及整齊的卡片佈局。

### 模式 A：標準優化模式 (不含提示詞)
1. 在網頁左側上傳 `.pptx` 報告。
2. 在網頁右側上傳 `.json` 評核檔。
3. **保持提示詞輸入框為空。**
4. 點擊「開始優化報告」。
5. **預期結果**：系統直接呼叫技能包，產出優化報告。

### 模式 B：AI 加工優化模式 (含提示詞)
1. 同樣上傳 `.pptx` 與 `.json`。
2. 在「優化提示詞」輸入框填入具體要求，例如：
   - "請特別加強根因分析部分的數據豐富度。"
   - "調整改善對策，建議加入製程自動化監修。"
3. 點擊「開始優化報告」。
4. **預期結果**：
   - 後端會顯示 `啟動 AI 加工模式`。
   - LLM 會先修飾 JSON 內容，最後才執行優化。

## 3. API 驗證 (使用 curl)

若要直接測試整合提示詞的載入點：

```bash
curl -X POST http://localhost:8000/api/upload \
  -F "report=@your_report.pptx" \
  -F "evaluation_json=@your_eval.json" \
  -F "prompt=請加強統計分析部分的專業性"
```

## 4. 下載功能驗證
1. 待優化完成後，點擊頁面上的「下載優化後的報告」按鈕。
2. 確認是否成功下載檔名開頭為 `improved_` 的檔案。

## 3. 預期結果
- 後端終端機應顯示處理進度。
- `uploads/` 資料夾中應出現原始上傳檔案與處理後的輸出檔案。
- 前端應提供正確的下載連結。

## 4. 常見問題排除
- **連接拒絕**: 檢查 8000 端口是否被佔用。
- **模組錯誤**: 確保已執行 `export PYTHONPATH=.`。
